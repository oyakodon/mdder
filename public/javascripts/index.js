// Generated by CoffeeScript 1.12.2
(function() {
  'use strict';
  var app, mdderCtrler;

  mdderCtrler = (function() {
    function mdderCtrler($scope, $smoothScroll, $sce, $http) {
      $scope.e_visible = false;
      $scope.ebtn_text = "Edit";
      $http.get('./doc').then(function(res) {
        var html;
        if (res.data) {
          $scope.raw_md = res.data;
          html = marked($scope.raw_md);
          return $scope.content = $sce.trustAsHtml(html);
        }
      });
      $scope.jumpTo = function(id) {
        return $smoothScroll.slow(id, null, null, null);
      };
      $scope.MdChanged = function() {
        var html;
        html = marked($scope.raw_md);
        return $scope.content = $sce.trustAsHtml(html);
      };
      $scope.EditBtnClicked = function() {
        $scope.e_visible = !$scope.e_visible;
        if ($scope.e_visible) {
          return $scope.ebtn_text = "Hide";
        } else {
          return $scope.ebtn_text = "Edit";
        }
      };
      $scope.FileDialog = function() {
        return document.getElementById('input').click();
      };
      $scope.$watch("mdFile", function(mdFile) {
        var reader;
        if (!mdFile) {
          return;
        }
        reader = new FileReader();
        reader.onload = function() {
          return $scope.$apply(function() {
            var html;
            $scope.raw_md = reader.result;
            html = marked($scope.raw_md);
            return $scope.content = $sce.trustAsHtml(html);
          });
        };
        return reader.readAsText(mdFile);
      });
    }

    return mdderCtrler;

  })();

  app = angular.module("mdder", ["smooth-scroll"]);

  app.directive("fileModel", function($parse) {
    return {
      restrict: "A",
      link: function(scope, element, attrs) {
        var model;
        model = $parse(attrs.fileModel);
        return element.bind("change", function() {
          return scope.$apply(function() {
            return model.assign(scope, element[0].files[0]);
          });
        });
      }
    };
  });

  app.controller("mdder-ctrl", mdderCtrler);

}).call(this);
